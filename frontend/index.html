<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bookshop | Welcome</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="login-body">
    <div class="container login-container" id="container">
        <div class="form-container sign-up-container">
            <form id="register-form">
                <h1>Create Account</h1>
                <input type="text" id="reg-firstName" placeholder="First Name" required />
                <input type="text" id="reg-lastName" placeholder="Last Name" required />
                <input type="email" id="reg-email" placeholder="Email" required />
                <input type="password" id="reg-password" placeholder="Password" required />
                <input type="text" id="reg-passwordHint" placeholder="Password Hint" />
                <button type="submit">Sign Up</button>
            </form>
        </div>
        <div class="form-container sign-in-container">
            <form id="login-form">
                <h1>Sign In</h1>
                <input type="email" id="login-email" placeholder="Email" required />
                <input type="password" id="login-password" placeholder="Password" required />
                <button type="submit">Sign In</button>
            </form>
        </div>
        <div class="overlay-container">
            <div class="overlay">
                <div class="overlay-panel overlay-left">
                    <h1>Welcome Back!</h1>
                    <p>Log in to access your dashboard.</p>
                    <button class="ghost" id="signIn">Sign In</button>
                </div>
                <div class="overlay-panel overlay-right">
                    <h1>Hello, Friend!</h1>
                    <p>Enter your details to start your journey.</p>
                    <button class="ghost" id="signUp">Sign Up</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        const signUpButton = document.getElementById('signUp');
        const signInButton = document.getElementById('signIn');
        const container = document.getElementById('container');
        signUpButton.addEventListener('click', () => container.classList.add('right-panel-active'));
        signInButton.addEventListener('click', () => container.classList.remove('right-panel-active'));
        
        document.addEventListener('DOMContentLoaded', () => {
            const registerForm = document.getElementById('register-form');
            const loginForm = document.getElementById('login-form');

            registerForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const body = {
                    firstName: document.getElementById('reg-firstName').value,
                    lastName: document.getElementById('reg-lastName').value,
                    email: document.getElementById('reg-email').value,
                    password: document.getElementById('reg-password').value,
                    passwordHint: document.getElementById('reg-passwordHint').value
                };
                const res = await fetch('/api/auth/register', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
                if (res.ok) {
                    alert('Registration successful! Please sign in.');
                    signInButton.click();
                } else {
                    alert('Registration failed.');
                }
            });

            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const body = { email: document.getElementById('login-email').value, password: document.getElementById('login-password').value };
                try {
                    const res = await fetch('/api/auth/login', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
                    const data = await res.json();
                    if (!res.ok) throw new Error(data.msg || 'Invalid credentials');
                    localStorage.setItem('token', data.token);
                    window.location.href = 'dashboard.html';
                } catch (error) { alert(error.message); }
            });
        });
    </script>
</body>
</html>